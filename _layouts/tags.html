---
layout: page
---

{{ content }}

{% assign documents = site.documents %}
{% assign featured_categories = documents | where: "type", "category" | sort %}
{% assign featured_tags = documents | where: "type", "tag" | sort %}

<div class="tags-category-grid">
  {% for category in featured_categories %}
    {% assign category_posts = site.categories[category.slug] %}
    {% unless category_posts %}
      {% assign category_posts = "" | split: "" %}
    {% endunless %}
    {% assign category_post_count = category_posts | size %}

    {% assign featured_category_tags = featured_tags | where:"category", category.slug %}
    {% assign featured_tag_slugs = featured_category_tags | map:"slug" %}
    {% assign category_tags_from_posts = category_posts | map:"tags" | join:"," | split:"," | uniq | sort | where_exp:"tag","tag != ''" %}
    {% assign category_tag_slugs = category_tags_from_posts | concat:featured_tag_slugs | uniq | sort %}

    <section id="{{ category.slug }}" class="tags-category-card hr">
      <div class="tags-category-card__header">
        <h2 class="tags-category-card__title">
          <a href="{{ category.url | relative_url }}">{{ category.title }}</a>
        </h2>
        <span class="tags-category-card__count">{{ category_post_count }}</span>
      </div>

      {% if category_tag_slugs.size > 0 %}
        <div class="category-tag-cloud">
          <div class="category-tag-cloud__title">Subtags</div>
          <div class="category-tag-cloud__list">
            {% for tag_slug in category_tag_slugs %}
              {% assign tag_meta = featured_category_tags | where:"slug", tag_slug | first %}
              {% assign tag_slugified = tag_slug | strip | slugify %}
              {% assign tag_title = tag_meta.title %}
              {% unless tag_title %}
                {% assign tag_words = tag_slugified | replace:'-',' ' | split:' ' %}
                {% capture tag_title %}
                  {% for word in tag_words %}
                    {% assign cap_word = word | capitalize %}
                    {{ cap_word }}{% unless forloop.last %} {% endunless %}
                  {% endfor %}
                {% endcapture %}
                {% assign tag_title = tag_title | strip %}
              {% endunless %}
              {% assign tag_url = tag_meta.url %}
              {% unless tag_url %}
                {% assign tag_url = '/tag-' | append:tag_slugified | append:'/' %}
              {% endunless %}
              {% assign tag_posts = site.tags[tag_slugified] %}
              {% assign tag_post_count = 0 %}
              {% if tag_posts %}
                {% assign tag_post_count = tag_posts | size %}
              {% endif %}
              {% assign tag_item_classes = 'category-tag-cloud__item' %}
              {% if tag_post_count == 0 %}
                {% assign tag_item_classes = tag_item_classes | append:' category-tag-cloud__item--empty' %}
              {% endif %}
              <a class="{{ tag_item_classes }}" href="{{ tag_url | relative_url }}">
                <span class="category-tag-cloud__name">{{ tag_title }}</span>
                <span class="category-tag-cloud__badge">{{ tag_post_count }}</span>
              </a>
            {% endfor %}
          </div>
        </div>
      {% endif %}
    </section>
  {% endfor %}
</div>
