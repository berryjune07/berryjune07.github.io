---
# Copyright (c) 2018 Florian Klampfer <https://qwtel.com/>
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

layout: page
---

{{ content }}

{% assign posts = site.tags[page.slug] %}
{% unless posts %}
  {% assign posts = "" | split: "" %}
{% endunless %}

{% if page.category %}
  {% assign category_meta = site.featured_categories | where:"slug", page.category | first %}
  {% assign category_title = category_meta.title %}
  {% assign category_url = category_meta.url %}
  {% unless category_url %}
    {% assign category_url = '/' | append:page.category | append:'/' %}
  {% endunless %}
  {% unless category_title %}
    {% assign category_words = page.category | replace:'-',' ' | split:' ' %}
    {% capture category_title %}
      {% for word in category_words %}
        {% assign cap_word = word | capitalize %}
        {{ cap_word }}{% unless forloop.last %} {% endunless %}
      {% endfor %}
    {% endcapture %}
    {% assign category_title = category_title | strip %}
  {% endunless %}
  <a class="tag-category-return" href="{{ category_url | relative_url }}">
    <span class="tag-category-return__icon" aria-hidden="true"><i class="fa-solid fa-arrow-left"></i></span>
    <span class="tag-category-return__text">return to {{ category_title }}</span>
  </a>
{% endif %}

{% assign date_formats  = site.data.strings.date_formats               %}
{% assign list_group_by = date_formats.list_group_by | default:"%Y"    %}
{% assign list_entry    = date_formats.list_entry    | default:"%d %b" %}

{% assign posts_latest = posts | sort: "date" | reverse %}
{% assign posts_oldest = posts | sort: "date" %}

<div class="post-sort-controls" role="group" aria-label="Sort posts">
  <button type="button" class="post-sort-button is-active" data-sort="latest" aria-label="Sort by latest">
    <span class="post-sort-icon fa-solid fa-arrow-down-short-wide" aria-hidden="true"></span>
    <span class="sr-only">Latest</span>
  </button>
  <button type="button" class="post-sort-button" data-sort="oldest" aria-label="Sort by oldest">
    <span class="post-sort-icon fa-solid fa-arrow-up-wide-short" aria-hidden="true"></span>
    <span class="sr-only">Oldest</span>
  </button>
</div>

<div class="post-sort-list is-active" data-sort-list="latest">
  {% include_cached components/post-list-grouped.html posts=posts_latest list_group_by=list_group_by list_entry=list_entry heading_class="hr" %}
</div>

<div class="post-sort-list" data-sort-list="oldest">
  {% include_cached components/post-list-grouped.html posts=posts_oldest list_group_by=list_group_by list_entry=list_entry heading_class="hr" %}
</div>

<script>
(function() {
  var controls = document.querySelector('.post-sort-controls');
  if (!controls) return;
  var buttons = controls.querySelectorAll('.post-sort-button');
  var lists = document.querySelectorAll('.post-sort-list');
  controls.addEventListener('click', function (event) {
    var btn = event.target.closest('.post-sort-button');
    if (!btn) return;
    var sort = btn.getAttribute('data-sort');
    buttons.forEach(function (button) {
      button.classList.toggle('is-active', button === btn);
    });
    lists.forEach(function (list) {
      list.classList.toggle('is-active', list.getAttribute('data-sort-list') === sort);
    });
  });
})();
</script>
