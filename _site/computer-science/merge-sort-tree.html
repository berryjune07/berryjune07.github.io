<!DOCTYPE html>
<html lang="en">







<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  






  
    
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Merge Sort Tree | Jiho’s Blog</title>
<meta name="generator" content="Jekyll v3.9.2">
<meta property="og:title" content="Merge Sort Tree">
<meta name="author" content="Jiho Jun">
<meta property="og:locale" content="en">
<meta name="description" content="noting down my thoughts and experiences">
<meta property="og:description" content="noting down my thoughts and experiences">
<link rel="canonical" href="http://localhost:4000/computer-science/merge-sort-tree.html">
<meta property="og:url" content="http://localhost:4000/computer-science/merge-sort-tree.html">
<meta property="og:site_name" content="Jiho’s Blog">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2025-11-12T00:00:00+09:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Merge Sort Tree">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jiho Jun"},"dateModified":"2025-11-12T00:00:00+09:00","datePublished":"2025-11-12T00:00:00+09:00","description":"noting down my thoughts and experiences","headline":"Merge Sort Tree","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/computer-science/merge-sort-tree.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/berry.jpg"},"name":"Jiho Jun"},"url":"http://localhost:4000/computer-science/merge-sort-tree.html"}</script>
<!-- End Jekyll SEO tag -->


  

  
    <meta name="keywords" content="Development,C++,Rust,Jekyll">
  



  <meta name="theme-color" content="rgb(31,55,75)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Jiho's Blog">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="Jiho's Blog">

<meta name="generator" content="Hydejack v9.1.6">



<link rel="alternate" href="http://localhost:4000/computer-science/merge-sort-tree.html" hreflang="en">

<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Jiho's Blog">


<link rel="shortcut icon" href="/assets/icons/favicon.ico">
<link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">

<link rel="manifest" href="/assets/site.webmanifest">

<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">


  <link rel="dns-prefetch" href="https://www.google-analytics.com">


<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">

  <link rel="dns-prefetch" href="/assets/js/search-worker-9.1.6.js" as="worker" id="_hrefSearch">





  <link rel="stylesheet" href="https://unpkg.com/applause-button/dist/applause-button.css">
  <script src="https://unpkg.com/applause-button/dist/applause-button.js"></script>


<!-- For sidebar folder -->
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">


  <link rel="stylesheet" href="/assets/css/lightbox.css">



<!-- Global site tag (gtag.js) - Google Analytics -->
<script defer src="https://www.googletagmanager.com/gtag/js?id=G-VMBTN8BX5P"></script>
<script>
    document.addEventListener("DOMContentLoaded", function(event) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        gtag('js', new Date());
        gtag('config', 'G-VMBTN8BX5P');
    });
</script>

<script>!function(r,c){"use strict";function a(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=c.createElement("script"),e=(n.src=e,t&&a(n,"load",t,{once:!0}),c.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=c.createElement("script");function o(){r._loaded=!0,t&&a(n,"load",t,{once:!0});var e=c.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():a(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){a(c.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}}(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = false;
  w._noToc = false;
  w._noSearch = false;
  w._advertise = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2025-12-03T23:28:18+09:00',
  };
}(window);</script>

<!-- font awesome -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css">

<!-- KATEX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/copy-tex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/mhchem.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/mathtex-script-type.min.js"></script>

<script src="/assets/js/katex.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    render_KaTeX();
  });
</script>

<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.1.6.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700%7CNoto+Sans+KR%7CJetBrains+Mono%7CNanum+Gothic+Coding&amp;display=swap" id="_fontsPreload">




<!--<![endif]-->





</head>

<body class="no-break-layout no-large-headings">
  
<script>
  window._sunrise = 6;
  window._sunset =  18;
  !function(e,s){var d="light-mode",o="dark-mode",a=(new Date).getHours();"matchMedia"in e&&e.matchMedia("(prefers-color-scheme)")||(e=(a=a<=e._sunrise||a>=e._sunset?o:d)==o?d:o,s.body.classList.add(a),s.body.classList.remove(e))}(window,document);

</script>



<hy-push-state id="_pushState" replace-selector="#_main" link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)" script-selector="script" duration="500" hashchange>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden>

  <main id="_main" class="content layout-post" role="main">
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/computer-science/">computer-science</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>merge-sort-tree.html</span>
        
      </li>
    
  
</ul></nav>

  










<article id="post-computer-science-merge-sort-tree" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        Merge Sort Tree
        
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2025-11-12T00:00:00+09:00">12 Nov 2025</time> in <a href="/computer-science/" class="flip-title">Computer Science</a> on <a href="/tag-algorithms/" class="flip-title">Algorithms</a>
      </span>
      
        
      

      <span class="additional-info" style="font-size:1rem">
          <!--
        <span class="page-pv">
          <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=http://localhost:4000/computer-science/merge-sort-tree.html&count_bg=%23000000&title_bg=%23000000&icon=openstreetmap.svg&icon_color=%23E7E7E7&title=Views&edge_flat=false"/>
        </span>
          -->
        ·
        <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->








<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="685 words">
  <i class="fa-regular fa-hourglass-half"></i>
   11 min
</span>

      </span>
    </div>

    
    

    



  <div class="hr pb0"></div>


  </header>

  
    <!--more-->
<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li>
<a href="#merge-sort-tree" id="markdown-toc-merge-sort-tree">Merge Sort Tree</a>    <ul>
      <li><a href="#explanation" id="markdown-toc-explanation">Explanation</a></li>
      <li><a href="#complexity" id="markdown-toc-complexity">Complexity</a></li>
    </ul>
  </li>
  <li>
<a href="#code" id="markdown-toc-code">Code</a>    <ul>
      <li><a href="#example" id="markdown-toc-example">Example</a></li>
    </ul>
  </li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>A <strong>merge sort tree</strong> is a specialized data structure that combines the properties of a segment tree with the ability to efficiently perform range queries on sorted data.
It usually does not support updates efficiently.</p>

<h2 id="merge-sort-tree">Merge Sort Tree</h2>

<h3 id="explanation">Explanation</h3>

<p>A merge sort tree is built on top of a segment tree, where each node contains a sorted list of elements corresponding to the segment it represents.
The tree is constructed by recursively dividing the array into segments and merging the sorted lists of child nodes.
Each node in the merge sort tree is a <em>multiset</em> (or sorted array), and the merge sort tree can only efficiently answer range queries that satisfy the following condition:</p>

<ul>
  <li>For the query function $F$, multisets $S_1,S_2$, and a query result combiner function $G(\cdot,\cdot)$,</li>
</ul>

<p>\[
F(S_1 \cup S_2) = G(F(S_1), F(S_2))
\]</p>

<p>This means that the result of the query on the union of two multisets can be computed by combining the results of the queries on each individual multiset,
and $F$ only depends on the order statistics of the array.</p>

<p>For example, for an array $[4,3,7,1,2,1,2,5]$, the merge sort tree would be built as follows:</p>

<pre><code class="language-mermaid">graph TD;
    A1[1,1,2,2,3,4,5,7];
    B1[1,3,4,7]; B2[1,2,2,5];
    C1[3,4]; C2[1,7]; C3[1,2]; C4[2,5];
    D1[4]; D2[3]; D3[7]; D4[1]; D5[2]; D6[1]; D7[2]; D8[5];
    
    A1 --&gt; B1; A1 --&gt; B2;
    B1 --&gt; C1; B1 --&gt; C2;
    B2 --&gt; C3; B2 --&gt; C4;
    C1 --&gt; D1; C1 --&gt; D2;
    C2 --&gt; D3; C2 --&gt; D4;
    C3 --&gt; D5; C3 --&gt; D6;
    C4 --&gt; D7; C4 --&gt; D8;
</code></pre>

<h3 id="complexity">Complexity</h3>

<p>Suppose the size of the input array is $N$, it takes $O(T(N))$ time to compute the query for a segment.</p>

<p>⁣1. <strong>Build</strong>: $O(N \log N)$</p>

<p>It takes $O(A+B)$ time to merge two sorted lists of sizes $A$ and $B$.
Since the size of array is $N$ and at each level of the segment tree we merge $N$ elements,
it takes $O(N)$ time per level.
The height of the segment tree is $O(\log N)$, so the total time complexity for building the merge sort tree is $O(N \log N)$.</p>

<p>⁣2. <strong>Query</strong>: $O(T(N) \log N)$</p>

<p>From <a href="/computer-science/segment-tree.html">here</a>, we know that for each range query, we visit $O(\log N)$ nodes in the segment tree.
At each visited node, we perform a query on the sorted list stored in that node, which takes $O(T(N))$ time.
Therefore, the total time complexity for a range query is $O(T(N) \log N)$.</p>

<p>⁣3. <strong>Space Complexity</strong>: $O(N \log N)$</p>

<p>The space complexity of a merge sort tree is $O(N \log N)$ because each level of the segment tree stores $N$ elements in sorted lists, and there are $O(\log N)$ levels in the tree.</p>

<h2 id="code">Code</h2>

<p>Let’s see the sample code.</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define all(v) v.begin(),v.end()
</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">TREE_SIZE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">ceil</span><span class="p">(</span><span class="n">log2</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">using</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">data</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// orderable data type</span>

<span class="n">data</span> <span class="n">A</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="k">struct</span> <span class="nc">Node</span><span class="p">{</span>
    <span class="n">vec</span> <span class="n">v</span><span class="p">;</span> <span class="c1">// sorted array</span>
    <span class="c1">// other members if needed</span>
<span class="p">}</span> <span class="n">tree</span><span class="p">[</span><span class="n">TREE_SIZE</span><span class="p">];</span>

<span class="n">Node</span> <span class="nf">merge_Node</span><span class="p">(</span><span class="n">Node</span> <span class="n">a</span><span class="p">,</span><span class="n">Node</span> <span class="n">b</span><span class="p">){</span>
    <span class="n">Node</span> <span class="n">res</span><span class="p">;</span>
    <span class="n">res</span><span class="p">.</span><span class="n">v</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
    <span class="n">merge</span><span class="p">(</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">v</span><span class="p">),</span> <span class="n">all</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">v</span><span class="p">),</span> <span class="n">res</span><span class="p">.</span><span class="n">v</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span>
    <span class="c1">// other member merges if needed</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Node</span> <span class="nf">conv</span><span class="p">(</span><span class="n">data</span> <span class="n">a</span><span class="p">){</span>
    <span class="n">Node</span> <span class="n">res</span><span class="p">;</span>
    <span class="n">res</span><span class="p">.</span><span class="n">v</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">};</span>
    <span class="c1">// other member initializations if needed</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">q</span> <span class="nf">F</span><span class="p">(</span><span class="n">Node</span> <span class="n">nd</span><span class="p">);</span> <span class="c1">// query function on a node</span>
<span class="n">q</span> <span class="nf">G</span><span class="p">(</span><span class="n">q</span> <span class="n">a</span><span class="p">,</span><span class="n">q</span> <span class="n">b</span><span class="p">);</span> <span class="c1">// query result combiner function</span>
<span class="n">q</span> <span class="nf">identity</span><span class="p">();</span> <span class="c1">// return identity query result</span>

<span class="n">Node</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">nd</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">==</span><span class="n">r</span><span class="p">)</span> <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">nd</span><span class="p">]</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">l</span><span class="p">]);</span>
    <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">nd</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge_Node</span><span class="p">(</span><span class="n">init</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">nd</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span><span class="n">init</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">nd</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">q</span> <span class="nf">Query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">nd</span><span class="p">,</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">e</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&lt;</span><span class="n">l</span> <span class="n">or</span> <span class="n">r</span><span class="o">&lt;</span><span class="n">s</span><span class="p">)</span> <span class="k">return</span> <span class="n">identity</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="o">&lt;=</span><span class="n">l</span> <span class="n">and</span> <span class="n">r</span><span class="o">&lt;=</span><span class="n">e</span><span class="p">)</span> <span class="k">return</span> <span class="n">F</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">nd</span><span class="p">]);</span>
    <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">G</span><span class="p">(</span><span class="n">Query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">nd</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">),</span><span class="n">Query</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">nd</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="example">Example</h3>

<p>Suppose we want to count the number of elements less than or equal to a given value $K$ in a range $[L, R]$ of the array.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">A</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="k">struct</span> <span class="nc">Node</span><span class="p">{</span>
    <span class="n">vec</span> <span class="n">v</span><span class="p">;</span>
<span class="p">}</span> <span class="n">tree</span><span class="p">[</span><span class="n">TREE_SIZE</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">F</span><span class="p">(</span><span class="n">Node</span> <span class="n">nd</span><span class="p">,</span> <span class="kt">int</span> <span class="n">K</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">upper_bound</span><span class="p">(</span><span class="n">all</span><span class="p">(</span><span class="n">nd</span><span class="p">.</span><span class="n">v</span><span class="p">),</span> <span class="n">K</span><span class="p">)</span><span class="o">-</span><span class="n">nd</span><span class="p">.</span><span class="n">v</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">G</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">identity</span><span class="p">(){</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In this example, time complexity of the query function $F$ is $T(N) = O(\log N)$ due to the binary search performed by <code class="language-plaintext highlighter-rouge">upper_bound</code>.
Thus, the overall time complexity for a range query becomes $O(\log^2 N)$.</p>

  
</article>



<applause-button class="mb6" color="rgb(0,174,239)" url="http://localhost:4000/computer-science/merge-sort-tree.html">
  </applause-button>






  
     


  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img src="/assets/img/piano.png" alt="Jiho Jun" class="avatar" width="120" height="120" loading="lazy">

  

  
  
  <h2 class="page-title hr-bottom">
    About
  </h2>

  <p>Hello. <br>
Please check my <a href="/resume/">Resume</a> to find out more about me!<br></p>



  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      




    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/phylosopher07" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      




    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:pianoforte0203@gmail.com" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://facebook.com/100078342350761" title="Facebook" class="no-mark-external">
      <span class="icon-facebook"></span>
      <span class="sr-only">Facebook</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>


  

  
    


  

  
    


                                                      <!--<aside class="other-projects related mb0" role="complementary">  <h2>Related Posts</h2>  <div class="columns">          <div class="column column-1-2">                  <article class="project-card">  <a href="/computer-science/euler-tour-technique.html" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine fallback-img">          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/computer-science/euler-tour-technique.html" class="flip-title">Euler Tour Technique</a>  </h3>      <a class="fill-card no-hover" href="/computer-science/euler-tour-technique.html" tabindex="-1"><span class="sr-only">Continue reading Euler Tour Technique</span></a></article>              </div>          <div class="column column-1-2">                  <article class="project-card">  <a href="/computer-science/mos-algorithm.html" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine fallback-img">          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/computer-science/mos-algorithm.html" class="flip-title">Mo's Algorithm</a>  </h3>      <a class="fill-card no-hover" href="/computer-science/mos-algorithm.html" tabindex="-1"><span class="sr-only">Continue reading Mo's Algorithm</span></a></article>              </div>      </div></aside>--><aside class="related mb4" role="complementary">  <h2 class="hr-bottom">Related Posts</h2>  <ul class="related-posts">          <li class="h4">  <a href="/computer-science/euler-tour-technique.html" class="flip-title">    <span>            Euler Tour Technique    </span>  </a>      <time class="faded fine" datetime="2025-11-26T00:00:00+09:00">      26 Nov 2025    </time>        <span class="clap-count" data-url="http://localhost:4000/computer-science/euler-tour-technique.html"></span>  </li>          <li class="h4">  <a href="/computer-science/mos-algorithm.html" class="flip-title">    <span>            Mo's Algorithm    </span>  </a>      <time class="faded fine" datetime="2025-11-12T00:00:00+09:00">      12 Nov 2025    </time>        <span class="clap-count" data-url="http://localhost:4000/computer-science/mos-algorithm.html"></span>  </li>          <li class="h4">  <a href="/computer-science/sqrt-decomposition.html" class="flip-title">    <span>            Sqrt Decomposition    </span>  </a>      <time class="faded fine" datetime="2025-11-11T00:00:00+09:00">      11 Nov 2025    </time>        <span class="clap-count" data-url="http://localhost:4000/computer-science/sqrt-decomposition.html"></span>  </li>          <li class="h4">  <a href="/computer-science/mertens-trick.html" class="flip-title">    <span>            Mertens Trick    </span>  </a>      <time class="faded fine" datetime="2025-11-11T00:00:00+09:00">      11 Nov 2025    </time>        <span class="clap-count" data-url="http://localhost:4000/computer-science/mertens-trick.html"></span>  </li>      </ul></aside>

  

  
    
<aside class="comments related" role="complementary">
  <h2 class="hr-bottom">Comments</h2>
  

  
  
    <!--
    <script type="text/javascript">
      $(function () {
        const origin = "https://giscus.app";
        const iframe = "iframe.giscus-frame";
        const lightTheme = "light";
        const darkTheme = "dark_dimmed";

        let giscusAttributes = {
          "src": "https://giscus.app/client.js",
          "data-repo": "berryjune07/berryjune07.github.io",
          "data-repo-id": "",
          "data-category": "General",
          "data-category-id": "",
          "data-mapping": "pathname",
          "data-strict": "0",
          "data-reactions-enabled": "",
          "data-emit-metadata": "0",
          "data-input-position": "",
          "data-theme": "light",
          "data-lang": "en",
          "data-loading": "lazy",
          "crossorigin": "anonymous",
          "async": ""
        };
        let giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
        document.getElementById("tail-wrapper").appendChild(giscusScript);
        addEventListener("message", (event) => {
          if (event.source === window && event.data &&
                  event.data.direction === ModeToggle.ID) {
            /* global theme mode changed */
            const mode = event.data.message;
            const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme);
            const message = {
              setConfig: {
                theme: theme
              }
            };
            const giscus = document.querySelector(iframe).contentWindow;
            giscus.postMessage({ giscus: message }, origin);
          }
        });
      });
    </script>
    -->

    <script src="https://giscus.app/client.js" data-repo="berryjune07/berryjune07.github.io" data-repo-id="" data-category="General" data-category-id="" data-mapping="pathname" data-strict="0" data-reactions-enabled="" data-emit-metadata="0" data-input-position="" data-theme="light" data-lang="en" data-loading="lazy" crossorigin="anonymous" async>
    </script>
  


</aside>


  

  
<footer class="content" role="contentinfo">
  <hr>
  
    <p><small class="copyright">© 2023. All rights reserved.
</small></p>
  
  
    <nav class="legal"><small>
    
      
      <a class="heading flip-title" href="/licenses/">LICENSES</a>
      |
    
      
      <a class="heading flip-title" href="/cookies-policy/">COOKIES POLICY</a>
      
    
    </small></nav>
  
  
  <hr class="sr-only">
</footer>


</main>

  <hy-drawer id="_drawer" class="" side="left" threshold="10" noscroll>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg " style="background:center / cover url(/assets/img/note.jpg)"></div>

    <div class="sidebar-sticky no-fouc">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="/assets/img/berry.jpg" class="avatar" alt="Jiho's Blog" width="120" height="120" loading="lazy">
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h1">Jiho's Blog</h2></a>
    
    
      <p class="">
        <em>Appassionato</em>

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
        
        
        <li>
          
          <div class="list-wrapper">
            <a href="/about/" class="sidebar-nav-item">About</a>
            
          </div>
          
        </li>
      
    
  
    
      
        
        
        <li>
          
            <input type="checkbox" id="folder-checkbox-10">
          
          <div class="list-wrapper">
            <a href="/mathematics/" class="sidebar-nav-item">Mathematics</a>
            
              <button class="spread-btn" onclick="javascript:spread(10)">
                <label id="spread-icon-10" class="material-icons">arrow_right</label>
              </button>
            
          </div>
          
            <ul class="list-body">
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-statistics/">Statistics</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-number-theory/">Number Theory</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-linear-algebra/">Linear Algebra</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-calculus/">Calculus</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-topology/">Topology</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-differential-geometry/">Differential Geometry</a>
                </li>
            </ul>
          
        </li>
      
    
  
    
      
        
        
        <li>
          
            <input type="checkbox" id="folder-checkbox-11">
          
          <div class="list-wrapper">
            <a href="/physics/" class="sidebar-nav-item">Physics</a>
            
              <button class="spread-btn" onclick="javascript:spread(11)">
                <label id="spread-icon-11" class="material-icons">arrow_right</label>
              </button>
            
          </div>
          
            <ul class="list-body">
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-classical-electromagnetism/">Classical Electromagnetism</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-quantum-mechanics/">Quantum Mechanics</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-fluid-mechanics/">Fluid Mechanics</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-classical-mechanics/">Classical Mechanics</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-elementary-physics/">Elementary Physics</a>
                </li>
            </ul>
          
        </li>
      
    
  
    
      
        
        
        <li>
          
            <input type="checkbox" id="folder-checkbox-12">
          
          <div class="list-wrapper">
            <a href="/computer-science/" class="sidebar-nav-item">Computer Science</a>
            
              <button class="spread-btn" onclick="javascript:spread(12)">
                <label id="spread-icon-12" class="material-icons">arrow_right</label>
              </button>
            
          </div>
          
            <ul class="list-body">
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-problem-solving/">Problem Solving</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-algorithms/">Algorithms</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-artificial-intelligence/">Artificial Intelligence</a>
                </li>
            </ul>
          
        </li>
      
    
  
    
      
        
        
        <li>
          
            <input type="checkbox" id="folder-checkbox-13">
          
          <div class="list-wrapper">
            <a href="/classical-music/" class="sidebar-nav-item">Classical Music</a>
            
              <button class="spread-btn" onclick="javascript:spread(13)">
                <label id="spread-icon-13" class="material-icons">arrow_right</label>
              </button>
            
          </div>
          
            <ul class="list-body">
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-ravel/">Ravel</a>
                </li>
            
          
            
                <li>
                  <a class="sidebar-nav-subitem" href="/tag-rachmaninoff/">Rachmaninoff</a>
                </li>
            </ul>
          
        </li>
      
    
  
    
      
        
        
        <li>
          
          <div class="list-wrapper">
            <a href="/posts.html" class="sidebar-nav-item">Posts</a>
            
          </div>
          
        </li>
      
    
  
    
      
        
        
        <li>
          
          <div class="list-wrapper">
            <a href="/tags/" class="sidebar-nav-item">Tags</a>
            
          </div>
          
        </li>
      
    
  
    
      
        
        
        <li>
          
          <div class="list-wrapper">
            <a href="/gallery.html" class="sidebar-nav-item">Gallery</a>
            
          </div>
          
        </li>
      
    
  
    
      
        
        
        <li>
          
          <div class="list-wrapper">
            <a href="/resume/" class="sidebar-nav-item">Resume</a>
            
          </div>
          
        </li>
      
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      




    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/phylosopher07" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      




    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:pianoforte0203@gmail.com" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://facebook.com/100078342350761" title="Facebook" class="no-mark-external">
      <span class="icon-facebook"></span>
      <span class="sr-only">Facebook</span>
    </a>
  </li>


    
  
</ul>

  </div>

  <!--
  <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=http://localhost:4000&count_bg=%23000000&title_bg=%23000000&icon=openstreetmap.svg&icon_color=%23E7E7E7&title=Visitors&edge_flat=false"/>
  -->

</div>

  </header>
</hy-drawer>
<hr class="sr-only" hidden>

</hy-push-state>


  <!--[if gt IE 10]><!---->
<script nomodule>!function(){var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())}();
</script>
<script src="/assets/js/hydejack-9.1.6.js" type="module"></script>
<script src="/assets/js/LEGACY-hydejack-9.1.6.js" nomodule defer></script>
<script src="/assets/js/sidebar-folder.js"></script>
<script src="/assets/js/clap-button.js"></script>
<script src="/assets/js/katex.js"></script>

  <script src="/assets/js/lightbox.js"></script>


<script type="module">
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs";
  let config = {
    startOnLoad: true,
    fontFamily: "JetBrains Mono",
    theme: "neutral"
  };
  mermaid.initialize(config);
  mermaid.run({ querySelector: ".language-mermaid" });
  document
    .getElementById("_pushState")
    .addEventListener("hy-push-state-after", function () {
      mermaid.run({ querySelector: ".language-mermaid" });
    });
</script>

<script>
  document
    .getElementById("_pushState")
    .addEventListener("hy-push-state-load", function () {
      get_clap_count();
      apply_lightbox();
    });
  document
    .getElementById("_pushState")
    .addEventListener("hy-push-state-after", function () {
      render_KaTeX();
    });
</script>


  <script>!function(w, d) {
    w.ga=w.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

    /**/
      if (navigator.CookiesOK) {
        ga('create', 'G-VMBTN8BX5P', 'auto');
      } else if (d.cookie.indexOf("hy--cookies-ok=true") > -1) {
        ga('create', 'G-VMBTN8BX5P', {
          'storage': 'none',
          'clientId': localStorage ? localStorage.getItem('ga--client-id') : undefined
        });
      } else {
        ga('create', 'G-VMBTN8BX5P', {
          'storage': 'none'
        });
        ga('set', 'forceSSL', true);
        ga('set', 'anonymizeIp', true);
      }
    /**/

    var pushStateEl = d.getElementById('_pushState');
    var timeoutId;
    pushStateEl.addEventListener('hy-push-state-load', function() {
      w.clearTimeout(timeoutId);
      timeoutId = w.setTimeout(function() {
        ga('set', 'page', w.location.pathname);
        ga('send', 'pageview');
      }, 500);
    });

    d.addEventListener('hy--cookies-ok', function () {
      w.ga(function(tracker) {
        w.ga("set", "anonymizeIp", undefined);
        localStorage && localStorage.setItem("ga--client-id", tracker.get("clientId"));
      });
    });

    w.loadJSDeferred('https://www.google-analytics.com/analytics.js');
  }(window, document);</script>


<script type="module">
  if ('serviceWorker' in navigator) {
    /**/
    navigator.serviceWorker.getRegistration()
      .then(r => r.unregister())
      .catch(() => {});
    /**/
  }
</script>
<!--<![endif]-->

  


<div hidden>
  
  <h2 class="sr-only">Templates (for web app):</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>

    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loading…</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Error</h1>
    
    
    <p class="lead">
      Sorry, an error occurred while loading <a class="this-link" href=""></a>.

    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
    <template id="_cookies-banner-template">
  <div id="_cookies-banner" class="navbar fixed-bottom CookiesOK">
    <div class="content">
      <div class="nav-btn-bar">
        <small class="faded">
          <span>This site uses cookies. <a href="/cookies-policy/">Cookies Policy</a>.
</span>
          <button id="_cookies-ok" class="btn btn-primary btn-sm">Okay</button>
        </small>
      </div>
    </div>
  </div>
</template>

  
  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover">
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
  
    <template id="_search-template">
  <button id="_search" class="nav-btn no-hover">
    <label class="sr-only" for="_search-input">Search</label>
    <span class="icon-search"></span>
  </button>
  <div id="_search-box">
    <div class="nav-btn">
      <span class="icon-search"></span>
    </div>
    <input id="_search-input" type="search" class="form-control form-control-lg nav-btn" placeholder="Build with JEKYLL_ENV=production to enable search.">
    <button type="reset" class="nav-btn no-hover">
      <span class="sr-only">Close</span>
      <span class="icon-cross"></span>
    </button>
  </div>
  <div id="_hits"></div>
</template>

  
</div>

<script src="https://static.elfsight.com/platform/platform.js" data-use-service-core defer></script>
<div class="elfsight-app-72805aa7-c85a-4e3d-ac49-24dba36d6185" data-elfsight-app-lazy></div>
</body>
</html>
